<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="color-scheme" content="dark light">
    <title>Relative motion equations simulator</title>
    <link rel="stylesheet" href="/src/styles.css">
    <script type="importmap">
    {
      "imports": {
        "three": "/node_modules/three/build/three.module.js",
        "satellite.js": "/node_modules/satellite.js/dist/satellite.es.js"
      }
    }
    </script>
</head>
<body>
    <div id="container">
        <h1>üõ∞Ô∏è Relative motion equations simulator</h1>
        
        <div id="canvas-container">
            <!-- „Éà„ÉÉ„Éó„Ç≥„É≥„Éà„É≠„Éº„É´„Éê„Éº -->
            <div id="top-controls">
                <!-- „Éè„É≥„Éê„Éº„Ç¨„Éº„É°„Éã„É•„Éº„Éú„Çø„É≥ -->
                <button id="hamburger-menu" class="hamburger-button" onclick="toggleSidebar()">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                
                <!-- „ÇØ„Ç§„ÉÉ„ÇØ„Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥ -->
                <div class="quick-actions">
                    <button class="action-button" onclick="resetSimulation()" title="Ë°õÊòü„ÇíÂàùÊúü‰ΩçÁΩÆ„Å´Êàª„Åô">
                        <span class="button-icon">üõ∞Ô∏èüîÑ</span>
                    </button>
                    <button class="action-button" onclick="resetView()" title="„Ç´„É°„É©„ÇíÂàùÊúü‰ΩçÁΩÆ„Å´Êàª„Åô">
                        <span class="button-icon">üé•üîÑ</span>
                    </button>
                </div>
            </div>
            
            <!-- Ë°õÊòüÈÖçÁΩÆ„Éë„Éç„É´ -->
            <div id="satellite-config-panel">
                <div class="panel-header" onclick="toggleSatelliteConfig()">
                    <h4 class="section-title">üõ∞Ô∏è Ë°õÊòüÈÖçÁΩÆ</h4>
                    <span id="satellite-config-toggle" class="toggle-icon">‚ñº</span>
                </div>
                <div id="satellite-config-content" class="panel-content">
                        <div class="control-group">
                            <label>ÈÖçÁΩÆ:</label>
                            <select id="placementPattern">
                                <option value="axis">Ëª∏‰∏ä-ÈÄüÂ∫¶0</option>
                                <option value="grid">Ê†ºÂ≠ê-ÈÄüÂ∫¶0</option>
                                <option value="random_position">„É©„É≥„ÉÄ„É†-ÈÄüÂ∫¶0</option>
                                <option value="random_position_velocity">„É©„É≥„ÉÄ„É†</option>
                                <option value="random_periodic">„É©„É≥„ÉÄ„É†-Âë®ÊúüËß£</option>
                                <option value="periodic_orbit">Ê•ïÂÜÜËªåÈÅì</option>
                                <option value="circular_orbit">ÂÜÜËªåÈÅì</option>
                                <option value="hexagonal_disk">ÂÜÜÁõ§ËªåÈÅì</option>
                                <option value="vbar_approach">V-barËªåÈÅì</option>
                                <option value="rbar_approach">R-barËªåÈÅì</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Êï∞:</label>
                            <input type="number" id="satelliteCount" min="1" max="5" value="1">
                        </div>
                        <div class="control-group">
                            <label>ÁØÑÂõ≤(m):</label>
                            <input type="number" id="orbitRadius" min="0.1" max="10000" step="0.1" value="10">
                        </div>
                    <div id="zAmplitudeControl" style="display: none;">
                        <div class="control-group">
                            <label>ZÊåØÂπÖ:</label>
                            <input type="range" id="zAmplitude" min="-3" max="3" step="0.1" value="0">
                            <span id="zAmplitudeValue">0.0</span>A
                        </div>
                    </div>
                    <div id="periodicParamsControl" style="display: none;">
                        <h5>Ê•ïÂÜÜËß£„Éë„É©„É°„Éº„Çø (A=ÁØÑÂõ≤„ÄÅB~F=AÊØî)</h5>
                        <div class="periodic-params-grid">
                            <div class="param-item">
                                <label>B/A:</label>
                                <input type="range" id="paramB" min="-3" max="3" step="0.1" value="0">
                                <span id="paramBValue">0.0</span>
                            </div>
                            <div class="param-item">
                                <label>D/A:</label>
                                <input type="range" id="paramD" min="-3" max="3" step="0.1" value="0">
                                <span id="paramDValue">0.0</span>
                            </div>
                            <div class="param-item">
                                <label>E/A:</label>
                                <input type="range" id="paramE" min="-3" max="3" step="0.1" value="0">
                                <span id="paramEValue">0.0</span>
                            </div>
                            <div class="param-item">
                                <label>F/A:</label>
                                <input type="range" id="paramF" min="-3" max="3" step="0.1" value="0">
                                <span id="paramFValue">0.0</span>
                            </div>
                        </div>
                        <div id="eccentricityDisplay" class="eccentricity-info">
                            <span class="eccentricity-label">Èõ¢ÂøÉÁéá e:</span>
                            <span id="eccentricityValue">0.00</span>
                        </div>
                    </div>
                    <div id="circularZDirectionControl" style="display: none;">
                        <div class="control-group">
                            <input type="checkbox" id="circularZDirection" checked>
                            <label>+ZÊñπÂêë</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- „Çµ„Ç§„Éâ„Éê„Éº -->
            <div id="sidebar" class="sidebar">
                <div class="sidebar-header">
                    <h3>Ë®≠ÂÆö</h3>
                    <button class="close-button" onclick="toggleSidebar()">√ó</button>
                </div>
                <div class="sidebar-content">
                    <!-- „Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥Âà∂Âæ° -->
                    <div class="subsection">
                        <h5 class="subsection-title">‚ö° „Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</h5>
                        <div class="control-row">
                            <div class="control-group" style="flex: 1;">
                                <label>Êé®Âäõ:</label>
                                <input type="number" id="thrustAmount" min="0.0001" max="1" step="0.0001" value="0.001" style="width: 70px;">
                                <span style="font-size: 11px;">m/s</span>
                            </div>
                            <div class="control-group" style="flex: 1;">
                                <label>ÊëÇÂãï:</label>
                                <input type="number" id="perturbationAmount" min="0.001" max="0.1" step="0.001" value="0.02" style="width: 70px;">
                                <span style="font-size: 11px;">m/s</span>
                            </div>
                        </div>
                        <div class="control-buttons">
                            <button onclick="addPerturbation()" style="font-size: 12px; padding: 6px 12px;">üí•ÊëÇÂãï</button>
                        </div>
                    </div>
            
                    <!-- 3DÁ©∫Èñì„Çµ„Éñ„Çª„ÇØ„Ç∑„Éß„É≥ -->
                    <div class="subsection">
                        <h5 class="subsection-title">üåå 3DÁ©∫ÈñìË°®Á§∫</h5>
                        <div class="control-row">
                            <div class="control-group" style="flex: 1;">
                                <input type="checkbox" id="showGrid" checked>
                                <label style="min-width: auto;">„Ç∞„É™„ÉÉ„Éâ</label>
                            </div>
                            <div class="control-group" style="flex: 1;">
                                <input type="checkbox" id="showEarth" checked>
                                <label style="min-width: auto;">Âú∞ÁêÉ</label>
                            </div>
                            <div class="control-group" style="flex: 2;">
                                <select id="earthTexture" style="width: 100%;">
                                    <option value="earth00.webp">„Ç∑„É≥„Éó„É´</option>
                                    <option value="earth01.webp">Ê®ôÊ∫ñ</option>
                                    <option value="earth03.webp">Ê∑°ÁôΩ</option>
                                    <option value="earth04.webp">„Éñ„É´„Éº„Éû„Éº„Éñ„É´</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ë°õÊòü„Çµ„Éñ„Çª„ÇØ„Ç∑„Éß„É≥ -->
                    <div class="subsection">
                        <h5 class="subsection-title">üõ∞Ô∏è Ë°õÊòüË°®Á§∫</h5>
                        <div class="control-row">
                            <div class="control-group" style="flex: 1;">
                                <label>„Çµ„Ç§„Ç∫:</label>
                                <input type="number" id="satelliteSize" min="0.1" max="100" step="0.1" value="0.8" style="width: 50px;">
                                <span style="font-size: 11px;">px</span>
                            </div>
                            <div class="control-group" style="flex: 1;">
                                <label>ÂΩ¢Áä∂:</label>
                                <select id="satelliteShape" style="width: 80px;">
                                    <option value="sphere">ÁêÉ‰Ωì</option>
                                    <option value="cube">Á´ãÊñπ‰Ωì</option>
                                </select>
                            </div>
                        </div>
                        <div class="control-row">
                            <div class="control-group" style="flex: 1;">
                                <input type="checkbox" id="uniformSatelliteColor">
                                <label style="min-width: auto;">Ëâ≤„ÇíÁµ±‰∏Ä</label>
                            </div>
                            <div class="control-group" style="flex: 1;">
                                <input type="color" id="satelliteColor" value="#ffffff" style="width: 50px;">
                            </div>
                        </div>
                        <div class="control-row">
                            <div class="control-group" style="flex: 1;">
                                <input type="checkbox" id="showTrails" checked>
                                <label style="min-width: auto;">ËªåË∑°Ë°®Á§∫</label>
                            </div>
                            <div class="control-group" style="flex: 2;">
                                <label>ËªåË∑°Èï∑„Åï:</label>
                                <input type="range" id="trailLength" min="50" max="500" step="50" value="200" style="width: 80px;">
                                <span id="trailLengthValue" style="font-size: 11px;">200</span>
                            </div>
                        </div>
                    </div>
            
                    <!-- Âü∫Ê∫ñËªåÈÅì -->
                    <div class="sidebar-section">
                        <div class="sidebar-section-header" onclick="toggleSidebarSection('reference-orbit')">
                            <span class="section-icon">üåç</span>
                            <h4 class="section-title">Âü∫Ê∫ñËªåÈÅì</h4>
                            <span id="reference-orbit-toggle" class="section-toggle">‚ñ∂</span>
                        </div>
                        <div id="reference-orbit" class="sidebar-section-content collapsed">
                            <div class="control-row">
                                <div class="control-group">
                                    <label>ËªåÈÅìÂÇæÊñúËßí(¬∞):</label>
                                    <input type="number" id="inclination" min="0" max="180" step="0.1" value="51.6">
                                </div>
                            </div>
                            <div class="control-row">
                                <div class="control-group">
                                    <label>Êòá‰∫§ÁÇπÁµåÂ∫¶(¬∞):</label>
                                    <input type="number" id="raan" min="0" max="360" step="0.1" value="0">
                                </div>
                            </div>
                            <div class="control-row">
                                <div class="control-group">
                                    <label>ËøëÂú∞ÁÇπÂºïÊï∞(¬∞):</label>
                                    <input type="number" id="argOfPerigee" min="0" max="360" step="0.1" value="0">
                                </div>
                            </div>
                            <div class="control-row">
                                <div class="control-group">
                                    <label>Âπ≥ÂùáËøëÁÇπËßí(¬∞):</label>
                                    <input type="number" id="meanAnomaly" min="0" max="360" step="0.1" value="0">
                                </div>
                            </div>
                            <div class="control-row">
                                <div class="control-group">
                                    <label>È´òÂ∫¶(km):</label>
                                    <input type="number" id="orbitAltitude" min="200" max="36000" step="50" value="500">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <canvas id="canvas"></canvas>
            <div id="axes-info">
                <div class="axis-label" style="color: #ff6b6b">RËª∏: Radial (ÂæÑÊñπÂêë - Âú∞ÂøÉ‚ÜíË°õÊòü)</div>
                <div class="axis-label" style="color: #2ECC71">SËª∏: Along-track (ËªåÈÅìÈÄ≤Ë°åÊñπÂêë)</div>
                <div class="axis-label" style="color: #00BFFF">WËª∏: Cross-track (ËªåÈÅìÈù¢ÂûÇÁõ¥ÊñπÂêë)</div>
            </div>
            
            <!-- Êäò„Çä„Åü„Åü„ÅøÂèØËÉΩ„Å™Âü∫Ê∫ñË°õÊòüÊÉÖÂ†±„Éë„Éç„É´ -->
            <div id="reference-satellite-panel">
                <button id="reference-satellite-toggle" class="panel-toggle" onclick="toggleReferenceSatelliteInfo()">
                    <span class="icon">üõ∞Ô∏è</span>
                    <span class="toggle-arrow">‚ñº</span>
                </button>
                <div id="reference-satellite-content" class="panel-content">
                    <div class="panel-column">
                        <div class="info-section">
                            <div class="panel-section-title">üìç ‰ΩçÁΩÆÊÉÖÂ†±</div>
                            <div id="geodetic-info" class="panel-info-content"></div>
                        </div>
                        <div class="info-section">
                            <div class="panel-section-title">üåç ECIÂ∫ßÊ®ôÁ≥ª</div>
                            <div id="eci-info" class="panel-info-content"></div>
                        </div>
                    </div>
                    <div class="panel-column">
                        <div class="info-section">
                            <div class="panel-section-title">üöÄ ËªåÈÅìË¶ÅÁ¥†</div>
                            <div id="orbital-info" class="panel-info-content"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ÊôÇÈñìÂà∂Âæ°„Éë„Éç„É´ -->
            <div id="time-controls-panel">
                <div id="time-scale-control">
                    <span class="icon">‚è±Ô∏è</span>
                    <select id="timeScale">
                        <option value="1">1x</option>
                        <option value="2">2x</option>
                        <option value="5">5x</option>
                        <option value="10">10x</option>
                        <option value="20">20x</option>
                        <option value="50">50x</option>
                        <option value="100" selected>100x</option>
                        <option value="200">200x</option>
                        <option value="500">500x</option>
                        <option value="1000">1000x</option>
                    </select>
                </div>
                <div id="time-display" onclick="togglePause()" title="„ÇØ„É™„ÉÉ„ÇØ„Åß‰∏ÄÊôÇÂÅúÊ≠¢/ÂÜçÈñã">
                    <span id="simulationTime">00ÂàÜ00Áßí</span>
                </div>
            </div>
            
        </div>
        
        

        

    </div>

    <script type="module" src="/src/main.ts"></script>
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const hamburger = document.getElementById('hamburger-menu');
            sidebar.classList.toggle('open');
            hamburger.classList.toggle('active');
        }
        
        function toggleSidebarSection(sectionId) {
            const section = document.getElementById(sectionId);
            const toggle = document.getElementById(sectionId + '-toggle');
            section.classList.toggle('collapsed');
            toggle.textContent = section.classList.contains('collapsed') ? '‚ñ∂' : '‚ñº';
        }
        
        function toggleSatelliteConfig() {
            const content = document.getElementById('satellite-config-content');
            const toggle = document.getElementById('satellite-config-toggle');
            
            if (content.style.display === 'none' || !content.style.display) {
                content.style.display = 'block';
                toggle.textContent = '‚ñº';
            } else {
                content.style.display = 'none';
                toggle.textContent = '‚ñ∂';
            }
        }
        
        // „Çµ„Ç§„Éâ„Éê„ÉºÂ§ñ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Åü„Å®„Åç„Å´Èñâ„Åò„Çã
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const hamburger = document.getElementById('hamburger-menu');
            if (sidebar.classList.contains('open') && 
                !sidebar.contains(event.target) && 
                !hamburger.contains(event.target)) {
                sidebar.classList.remove('open');
                hamburger.classList.remove('active');
            }
        });
    </script>
</body>
</html>