<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="color-scheme" content="dark light">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Relative motion equations(HCW) simulator</title>
    <link rel="stylesheet" href="./src/styles.css">
</head>
<body class="m-0 p-0 font-sans bg-zinc-950 text-white overflow-hidden">
    <div id="container" class="w-screen h-screen relative flex flex-col">
        <div id="canvas-container" class="relative w-full h-screen bg-gradient-radial from-slate-900/95 to-black overflow-hidden touch-none">
            <!-- „Éà„ÉÉ„Éó„Ç≥„É≥„Éà„É≠„Éº„É´„Éê„Éº -->
            <div id="top-controls" class="absolute top-5 left-5 flex gap-3 items-center z-[1000]">
                <!-- „Éè„É≥„Éê„Éº„Ç¨„Éº„É°„Éã„É•„Éº„Éú„Çø„É≥ -->
                <button id="hamburger-menu" class="hamburger-button w-10 h-10 p-0 bg-black/70 border border-orange-500/30 rounded-lg cursor-pointer flex flex-col justify-center items-center gap-1 transition-all duration-300 hover:bg-orange-500/20 hover:border-orange-500 hover:shadow-[0_0_15px_rgba(255,127,80,0.3)]" onclick="toggleSidebar()">
                    <span class="hamburger-line w-6 h-0.5 bg-orange-500 transition-all duration-300 block"></span>
                    <span class="hamburger-line w-6 h-0.5 bg-orange-500 transition-all duration-300 block"></span>
                    <span class="hamburger-line w-6 h-0.5 bg-orange-500 transition-all duration-300 block"></span>
                </button>
                
                <!-- „ÇØ„Ç§„ÉÉ„ÇØ„Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥ -->
                <div class="quick-actions flex gap-2">
                    <button class="action-button flex items-center gap-1.5 px-3.5 py-2 bg-black/70 border border-orange-500/30 rounded-lg text-orange-500 text-[13px] font-semibold cursor-pointer transition-all duration-300 backdrop-blur-lg h-10 hover:bg-orange-500/20 hover:border-orange-500 hover:-translate-y-0.5 hover:shadow-[0_4px_15px_rgba(255,127,80,0.4)] active:translate-y-0" onclick="openFormationDesigner()" title="„Éï„Ç©„Éº„É°„Éº„Ç∑„Éß„É≥Ë®≠Ë®à">
                        <span class="button-icon text-base drop-shadow-[0_0_3px_rgba(255,127,80,0.5)]">üîß</span>
                        <span class="text-xs">„Éï„Ç©„Éº„É°„Éº„Ç∑„Éß„É≥</span>
                    </button>
                    <button class="action-button flex items-center gap-1.5 px-3.5 py-2 bg-black/70 border border-orange-500/30 rounded-lg text-orange-500 text-[13px] font-semibold cursor-pointer transition-all duration-300 backdrop-blur-lg h-10 hover:bg-orange-500/20 hover:border-orange-500 hover:-translate-y-0.5 hover:shadow-[0_4px_15px_rgba(255,127,80,0.4)] active:translate-y-0" onclick="resetPositions()" title="Ë°õÊòü„ÇíÂàùÊúü‰ΩçÁΩÆ„Å´Êàª„Åô">
                        <span class="button-icon text-base drop-shadow-[0_0_3px_rgba(255,127,80,0.5)]">üõ∞Ô∏èüîÑ</span>
                    </button>
                    <button class="action-button flex items-center gap-1.5 px-3.5 py-2 bg-black/70 border border-orange-500/30 rounded-lg text-orange-500 text-[13px] font-semibold cursor-pointer transition-all duration-300 backdrop-blur-lg h-10 hover:bg-orange-500/20 hover:border-orange-500 hover:-translate-y-0.5 hover:shadow-[0_4px_15px_rgba(255,127,80,0.4)] active:translate-y-0" onclick="resetFormation()" title="„Éï„Ç©„Éº„É°„Éº„Ç∑„Éß„É≥Ë®≠ÂÆö„Çí„É™„Çª„ÉÉ„Éà">
                        <span class="button-icon text-base drop-shadow-[0_0_3px_rgba(255,127,80,0.5)]">‚öôÔ∏èüîÑ</span>
                    </button>
                    <button class="action-button flex items-center gap-1.5 px-3.5 py-2 bg-black/70 border border-orange-500/30 rounded-lg text-orange-500 text-[13px] font-semibold cursor-pointer transition-all duration-300 backdrop-blur-lg h-10 hover:bg-orange-500/20 hover:border-orange-500 hover:-translate-y-0.5 hover:shadow-[0_4px_15px_rgba(255,127,80,0.4)] active:translate-y-0" onclick="resetView()" title="„Ç´„É°„É©„ÇíÂàùÊúü‰ΩçÁΩÆ„Å´Êàª„Åô">
                        <span class="button-icon text-base drop-shadow-[0_0_3px_rgba(255,127,80,0.5)]">üé•üîÑ</span>
                    </button>
                </div>
            </div>

            <!-- CSVÂÜçÁîüÂà∂Âæ°„Éë„Éç„É´ -->
            <div id="csv-playback-panel" class="absolute top-[70px] left-5 bg-gradient-to-br from-slate-900/95 to-slate-800/90 rounded-2xl border border-orange-500/25 backdrop-blur-xl shadow-[0_8px_32px_rgba(0,0,0,0.4),0_0_80px_rgba(255,127,80,0.1)] max-w-xs z-[100] overflow-hidden before:content-[''] before:absolute before:top-0 before:left-0 before:right-0 before:h-[1px] before:bg-gradient-to-r before:from-transparent before:via-orange-500/50 before:to-transparent before:animate-[shimmer_3s_ease-in-out_infinite]" style="display: none;">
                <div class="panel-header px-3.5 py-2.5 cursor-pointer select-none flex justify-between items-center bg-orange-500/[0.08] border-b border-orange-500/15 transition-all duration-300 hover:bg-orange-500/15 hover:pl-4" onclick="toggleCSVControls()">
                    <h4 class="section-title text-orange-400 text-[15px] font-bold m-0 border-none p-0 drop-shadow-[0_0_20px_rgba(255,127,80,0.5)] tracking-[0.5px]">üìä CSVÂÜçÁîü„É¢„Éº„Éâ</h4>
                    <span id="csv-controls-toggle" class="toggle-icon text-orange-400 text-xs transition-transform duration-300">‚ñº</span>
                </div>
                <div id="csv-controls-content" class="panel-content p-3 overflow-hidden transition-all duration-300 flex flex-col gap-2.5">
                    <!-- Playback Controls -->
                    <div class="control-group flex items-center gap-2">
                        <button id="csvPlayPauseMain" class="px-3 py-1.5 bg-orange-500/20 border border-orange-500/30 rounded-lg text-orange-400 text-[13px] font-semibold cursor-pointer transition-all duration-300 hover:bg-orange-500/30 hover:border-orange-500 hover:text-white">‚ñ∂ ÂÜçÁîü</button>
                        <button id="csvStopMain" class="px-3 py-1.5 bg-orange-500/20 border border-orange-500/30 rounded-lg text-orange-400 text-[13px] font-semibold cursor-pointer transition-all duration-300 hover:bg-orange-500/30 hover:border-orange-500 hover:text-white">‚èπ ÂÅúÊ≠¢</button>
                    </div>
                    
                    <!-- Time Control -->
                    <div class="control-group">
                        <input type="range" id="csvTimeSliderMain" min="0" max="100" step="0.1" value="0" class="w-full h-1 bg-white/10 rounded-sm appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3.5 [&::-webkit-slider-thumb]:h-3.5 [&::-webkit-slider-thumb]:bg-gradient-to-br [&::-webkit-slider-thumb]:from-orange-400 [&::-webkit-slider-thumb]:to-orange-600 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:shadow-[0_2px_6px_rgba(0,0,0,0.3),0_0_8px_rgba(255,127,80,0.4)] [&::-webkit-slider-thumb]:transition-all [&::-webkit-slider-thumb]:duration-200 [&::-webkit-slider-thumb]:hover:scale-125 [&::-webkit-slider-thumb]:hover:shadow-[0_2px_10px_rgba(0,0,0,0.4),0_0_16px_rgba(255,127,80,0.6)]">
                        <div class="flex justify-between items-center mt-1">
                            <span class="text-[12px] text-orange-300/80 font-mono">
                                <span id="csvCurrentTimeMain">0</span>s / <span id="csvTotalTimeMain">0</span>s
                            </span>
                        </div>
                    </div>
                    
                    <!-- Loop Control -->
                    <div class="control-group flex items-center gap-2">
                        <input type="checkbox" id="csvLoopEnabledMain" checked class="w-4 h-4 cursor-pointer accent-orange-500">
                        <label for="csvLoopEnabledMain" class="text-[13px] text-orange-400">„É´„Éº„ÉóÂÜçÁîü</label>
                    </div>
                </div>
            </div>
            
            <!-- „Çµ„Ç§„Éâ„Éê„Éº -->
            <div id="sidebar" class="sidebar fixed top-0 left-[-400px] w-[380px] h-screen bg-gradient-to-b from-slate-900/98 to-slate-800/95 border-r border-orange-500/25 transition-[left] duration-300 ease-out z-[9999] overflow-hidden backdrop-blur-[30px] shadow-[4px_0_24px_rgba(0,0,0,0.5),0_0_80px_rgba(255,127,80,0.05)] before:content-[''] before:absolute before:top-0 before:right-0 before:bottom-0 before:w-[1px] before:bg-gradient-to-b before:from-transparent before:via-orange-500/50 before:to-transparent before:animate-[pulseGlow_4s_ease-in-out_infinite] flex flex-col">
                <div class="sidebar-header px-5 py-3 bg-orange-500/[0.08] border-b border-orange-500/20 flex justify-between items-center relative overflow-hidden after:content-[''] after:absolute after:bottom-0 after:left-0 after:right-0 after:h-[1px] after:bg-gradient-to-r after:from-transparent after:via-orange-500/60 after:to-transparent after:animate-[shimmer_3s_ease-in-out_infinite]">
                    <h3 class="text-orange-400 m-0 text-xl font-bold drop-shadow-[0_0_20px_rgba(255,127,80,0.5)] tracking-[1px]">Ë®≠ÂÆö</h3>
                    <div class="header-buttons flex gap-2">
                        <button class="help-button w-9 h-9 p-0 bg-white/5 border border-orange-500/30 rounded-lg text-orange-400 text-lg font-bold cursor-pointer flex items-center justify-center transition-all duration-300 hover:scale-110 hover:bg-orange-500/20 hover:border-orange-500 hover:text-white hover:shadow-[0_0_20px_rgba(255,127,80,0.4)]" onclick="window.open('https://github.com/istellartech2/hcw-vis/blob/main/README.md', '_blank')" title="„Éò„É´„Éó">?</button>
                        <button class="close-button w-9 h-9 p-0 bg-white/5 border border-orange-500/30 rounded-lg text-orange-400 text-xl cursor-pointer flex items-center justify-center transition-all duration-300 hover:rotate-90 hover:scale-110 hover:bg-orange-500/20 hover:border-orange-500 hover:text-white hover:shadow-[0_0_20px_rgba(255,127,80,0.4)]" onclick="toggleSidebar()">√ó</button>
                    </div>
                </div>

                <!-- „Çø„Éñ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ -->
                <div class="tab-navigation flex border-b border-orange-500/20 bg-gradient-to-b from-slate-900/80 to-slate-900/60 backdrop-blur-sm">
                    <button class="tab-button active flex-1 flex flex-col items-center gap-1 py-3 px-2 bg-transparent border-none text-orange-400/60 cursor-pointer transition-all duration-300 relative hover:text-orange-400 hover:bg-white/[0.02]" onclick="switchTab('simulation')" data-tab="simulation">
                        <span class="tab-icon text-xl">‚ö°</span>
                        <span class="tab-label text-[11px] font-semibold uppercase tracking-[0.5px]">„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</span>
                        <div class="tab-indicator absolute bottom-0 left-0 right-0 h-[2px] bg-gradient-to-r from-orange-500/0 via-orange-500 to-orange-500/0 opacity-0 transition-opacity duration-300"></div>
                    </button>
                    <button class="tab-button flex-1 flex flex-col items-center gap-1 py-3 px-2 bg-transparent border-none text-orange-400/60 cursor-pointer transition-all duration-300 relative hover:text-orange-400 hover:bg-white/[0.02]" onclick="switchTab('display')" data-tab="display">
                        <span class="tab-icon text-xl">üé®</span>
                        <span class="tab-label text-[11px] font-semibold uppercase tracking-[0.5px]">Ë°®Á§∫</span>
                        <div class="tab-indicator absolute bottom-0 left-0 right-0 h-[2px] bg-gradient-to-r from-orange-500/0 via-orange-500 to-orange-500/0 opacity-0 transition-opacity duration-300"></div>
                    </button>
                    <button class="tab-button flex-1 flex flex-col items-center gap-1 py-3 px-2 bg-transparent border-none text-orange-400/60 cursor-pointer transition-all duration-300 relative hover:text-orange-400 hover:bg-white/[0.02]" onclick="switchTab('playback')" data-tab="playback">
                        <span class="tab-icon text-xl">üìä</span>
                        <span class="tab-label text-[11px] font-semibold uppercase tracking-[0.5px]">ÂÜçÁîü„É¢„Éº„Éâ</span>
                        <div class="tab-indicator absolute bottom-0 left-0 right-0 h-[2px] bg-gradient-to-r from-orange-500/0 via-orange-500 to-orange-500/0 opacity-0 transition-opacity duration-300"></div>
                    </button>
                </div>

                <div class="sidebar-content p-3 overflow-y-auto flex-1">
                    <!-- „Çø„Éñ„Ç≥„É≥„ÉÜ„É≥„ÉÑ: „Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ -->
                    <div id="tab-simulation" class="tab-content active">
                    <!-- „Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥Âà∂Âæ° -->
                    <div class="subsection mb-2 p-2 bg-gradient-to-br from-white/[0.04] to-white/[0.02] border border-orange-500/15 rounded-xl relative overflow-hidden transition-all duration-300 hover:from-white/[0.06] hover:to-white/[0.03] hover:border-orange-500/30 hover:-translate-y-[1px] hover:shadow-[0_4px_12px_rgba(255,127,80,0.1)] before:content-[''] before:absolute before:top-[-1px] before:left-[-1px] before:right-[-1px] before:h-[1px] before:bg-gradient-to-r before:from-transparent before:via-orange-500/40 before:to-transparent before:opacity-0 before:transition-opacity before:duration-300 hover:before:opacity-100">
                        <h5 class="subsection-title text-orange-400 text-xs font-bold m-0 mb-1 pb-1 border-b border-orange-500/20 uppercase tracking-[1px] flex items-center gap-2">‚ö° „Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</h5>
                        <div class="control-row">
                            <div class="control-group">
                                <input type="checkbox" id="j2Perturbation" class="w-4 h-4 cursor-pointer accent-orange-500">
                                <label for="j2Perturbation" class="text-orange-400 text-xs font-semibold uppercase tracking-[0.5px] opacity-90 cursor-pointer">J2ÊëÇÂãï„ÇíËÄÉÊÖÆ</label>
                            </div>
                        </div>
                        <div class="control-row">
                            <div class="control-group">
                                <input type="checkbox" id="j2StableArrangement" class="w-4 h-4 cursor-pointer accent-orange-500">
                                <label for="j2StableArrangement" class="text-orange-400 text-xs font-semibold uppercase tracking-[0.5px] opacity-90 cursor-pointer">Ë°õÊòüÈÖçÁΩÆ„ÇíJ2ÂÆâÂÆöÈÖçÁΩÆ„Å´„Åô„Çã</label>
                            </div>
                        </div>
                    </div>

                    <!-- Âü∫Ê∫ñËªåÈÅì -->
                    <div class="subsection mb-2 p-2 bg-gradient-to-br from-white/[0.04] to-white/[0.02] border border-orange-500/15 rounded-xl relative overflow-hidden transition-all duration-300 hover:from-white/[0.06] hover:to-white/[0.03] hover:border-orange-500/30 hover:-translate-y-[1px] hover:shadow-[0_4px_12px_rgba(255,127,80,0.1)] before:content-[''] before:absolute before:top-[-1px] before:left-[-1px] before:right-[-1px] before:h-[1px] before:bg-gradient-to-r before:from-transparent before:via-orange-500/40 before:to-transparent before:opacity-0 before:transition-opacity before:duration-300 hover:before:opacity-100">
                        <h5 class="subsection-title text-orange-400 text-xs font-bold m-0 mb-1 pb-1 border-b border-orange-500/20 uppercase tracking-[1px] flex items-center gap-2">üåç Âü∫Ê∫ñËªåÈÅì</h5>
                        <div id="reference-orbit">
                            <div class="control-row">
                                <div class="control-group">
                                    <label class="label-no-uppercase">È´òÂ∫¶ <span class="text-[10px] opacity-70 font-normal normal-case">(km)</span>:</label>
                                    <input type="number" id="orbitAltitude" min="200" max="36000" step="50" value="500">
                                </div>
                            </div>
                            <div class="control-row">
                                <div class="control-group">
                                    <label class="label-no-uppercase">ÂÇæÊñúËßí <span class="text-[10px] opacity-70 font-normal normal-case">(¬∞)</span>:</label>
                                    <input type="number" id="inclination" min="0" max="180" step="0.1" value="51.6">
                                </div>
                            </div>
                            <div class="control-row">
                                <div class="control-group">
                                    <label class="label-no-uppercase">Êòá‰∫§ÁÇπ <span class="text-[10px] opacity-70 font-normal normal-case">(¬∞)</span>:</label>
                                    <input type="number" id="raan" min="0" max="360" step="1" value="0">
                                </div>
                            </div>
                            <div class="control-row">
                                <div class="control-group">
                                    <label class="label-no-uppercase">ËøëÂú∞ÁÇπ <span class="text-[10px] opacity-70 font-normal normal-case">(¬∞)</span>:</label>
                                    <input type="number" id="argOfPerigee" min="0" max="360" step="1" value="0">
                                </div>
                            </div>
                            <div class="control-row">
                                <div class="control-group">
                                    <label class="label-no-uppercase">Âπ≥ÂùáËøëÁÇπËßí <span class="text-[10px] opacity-70 font-normal normal-case">(¬∞)</span>:</label>
                                    <input type="number" id="meanAnomaly" min="0" max="360" step="1" value="0">
                                </div>
                            </div>
                            <div class="control-buttons flex flex-wrap gap-1.5 mt-2">
                                <button id="orbitUpdateButton" class="orbit-update-button text-xs px-3 py-1.5" disabled title="ÂÖ•ÂäõÂÄ§„ÇíÂü∫Ê∫ñËªåÈÅì„Å´ÂèçÊò†">Êõ¥Êñ∞</button>
                            </div>
                        </div>
                    </div>

                    <!-- Â§ñÂäõ -->
                    <div class="subsection mb-2 p-2 bg-gradient-to-br from-white/[0.04] to-white/[0.02] border border-orange-500/15 rounded-xl relative overflow-hidden transition-all duration-300 hover:from-white/[0.06] hover:to-white/[0.03] hover:border-orange-500/30 hover:-translate-y-[1px] hover:shadow-[0_4px_12px_rgba(255,127,80,0.1)] before:content-[''] before:absolute before:top-[-1px] before:left-[-1px] before:right-[-1px] before:h-[1px] before:bg-gradient-to-r before:from-transparent before:via-orange-500/40 before:to-transparent before:opacity-0 before:transition-opacity before:duration-300 hover:before:opacity-100">
                        <h5 class="subsection-title text-orange-400 text-xs font-bold m-0 mb-1 pb-1 border-b border-orange-500/20 uppercase tracking-[1px] flex items-center gap-2">üí´ Â§ñÂäõ</h5>
                        <div class="control-row">
                            <div class="control-group">
                                <label>Êé®Âäõ <span class="text-[10px] opacity-70 font-normal normal-case">(m/s)</span>:</label>
                                <input type="number" id="thrustAmount" min="0.0001" max="1" step="0.0001" value="0.001" style="width: 100px;">
                            </div>
                        </div>
                        <div class="control-row">
                            <div class="control-group">
                                <label>ÊëÇÂãï <span class="text-[10px] opacity-70 font-normal normal-case">(m/s)</span>:</label>
                                <input type="number" id="perturbationAmount" min="0.001" max="0.1" step="0.001" value="0.02" style="width: 100px;">
                            </div>
                        </div>
                        <div class="control-buttons flex flex-wrap gap-1.5 mt-1.5">
                            <button onclick="addPerturbation()" class="text-xs px-3 py-1.5">üí• ÊëÇÂãï„ÇíÂä†„Åà„Çã</button>
                        </div>
                    </div>
                    </div>
                    <!-- „Çø„Éñ„Ç≥„É≥„ÉÜ„É≥„ÉÑÁµÇ‰∫Ü: „Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ -->

                    <!-- „Çø„Éñ„Ç≥„É≥„ÉÜ„É≥„ÉÑ: Ë°®Á§∫ -->
                    <div id="tab-display" class="tab-content" style="display: none;">
                    <!-- 3DÁ©∫Èñì„Çµ„Éñ„Çª„ÇØ„Ç∑„Éß„É≥ -->
                    <div class="subsection mb-2 p-2 bg-gradient-to-br from-white/[0.04] to-white/[0.02] border border-orange-500/15 rounded-xl relative overflow-hidden transition-all duration-300 hover:from-white/[0.06] hover:to-white/[0.03] hover:border-orange-500/30 hover:-translate-y-[1px] hover:shadow-[0_4px_12px_rgba(255,127,80,0.1)] before:content-[''] before:absolute before:top-[-1px] before:left-[-1px] before:right-[-1px] before:h-[1px] before:bg-gradient-to-r before:from-transparent before:via-orange-500/40 before:to-transparent before:opacity-0 before:transition-opacity before:duration-300 hover:before:opacity-100">
                        <h5 class="subsection-title text-orange-400 text-xs font-bold m-0 mb-1 pb-1 border-b border-orange-500/20 uppercase tracking-[1px] flex items-center gap-2">üåå 3DÁ©∫ÈñìË°®Á§∫</h5>
                        <div class="checkbox-grid grid grid-cols-3 gap-3 mb-3">
                            <div class="checkbox-item flex items-center gap-2">
                                <input type="checkbox" id="showGrid" checked class="w-4 h-4 cursor-pointer accent-orange-500">
                                <label for="showGrid" class="text-orange-400 text-xs font-semibold uppercase tracking-[0.5px] opacity-90 cursor-pointer min-w-0">„Ç∞„É™„ÉÉ„Éâ</label>
                            </div>
                            <div class="checkbox-item flex items-center gap-2">
                                <input type="checkbox" id="showAxes" checked class="w-4 h-4 cursor-pointer accent-orange-500">
                                <label for="showAxes" class="text-orange-400 text-xs font-semibold uppercase tracking-[0.5px] opacity-90 cursor-pointer min-w-0">Â∫ßÊ®ôËª∏</label>
                            </div>
                            <div class="checkbox-item flex items-center gap-2">
                                <input type="checkbox" id="showLatLongGrid" checked class="w-4 h-4 cursor-pointer accent-orange-500">
                                <label for="showLatLongGrid" class="text-orange-400 text-xs font-semibold uppercase tracking-[0.5px] opacity-90 cursor-pointer min-w-0">Á∑ØÂ∫¶ÁµåÂ∫¶</label>
                            </div>
                            <div class="checkbox-item flex items-center gap-2">
                                <input type="checkbox" id="showEarth" checked class="w-4 h-4 cursor-pointer accent-orange-500">
                                <label for="showEarth" class="text-orange-400 text-xs font-semibold uppercase tracking-[0.5px] opacity-90 cursor-pointer min-w-0">Âú∞ÁêÉ</label>
                            </div>
                        </div>
                        <div class="control-row">
                            <div class="control-group">
                                <label>„ÉÜ„ÇØ„Çπ„ÉÅ„É£:</label>
                                <select id="earthTexture">
                                    <option value="earth00.webp">„Ç∑„É≥„Éó„É´</option>
                                    <option value="earth01.webp">Ê®ôÊ∫ñ</option>
                                    <option value="earth03.webp">Ê∑°ÁôΩ</option>
                                    <option value="earth04.webp">„Éñ„É´„Éº„Éû„Éº„Éñ„É´</option>
                                    <option value="earth05_highres.webp">È´òËß£ÂÉèÂ∫¶</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ë°õÊòü„Çµ„Éñ„Çª„ÇØ„Ç∑„Éß„É≥ -->
                    <div class="subsection mb-2 p-2 bg-gradient-to-br from-white/[0.04] to-white/[0.02] border border-orange-500/15 rounded-xl relative overflow-hidden transition-all duration-300 hover:from-white/[0.06] hover:to-white/[0.03] hover:border-orange-500/30 hover:-translate-y-[1px] hover:shadow-[0_4px_12px_rgba(255,127,80,0.1)] before:content-[''] before:absolute before:top-[-1px] before:left-[-1px] before:right-[-1px] before:h-[1px] before:bg-gradient-to-r before:from-transparent before:via-orange-500/40 before:to-transparent before:opacity-0 before:transition-opacity before:duration-300 hover:before:opacity-100">
                        <h5 class="subsection-title text-orange-400 text-xs font-bold m-0 mb-1 pb-1 border-b border-orange-500/20 uppercase tracking-[1px] flex items-center gap-2">üõ∞Ô∏è Ë°õÊòüË°®Á§∫</h5>
                        <div class="control-row">
                            <div class="control-group">
                                <label id="satelliteSizeLabel" class="label-no-uppercase">„Çµ„Ç§„Ç∫ <span class="text-[10px] opacity-70 font-normal normal-case">(m)</span>:</label>
                                <input type="number" id="satelliteSize" min="0.01" max="100" step="0.01" value="1.0" style="width: 80px;">
                                <span id="satelliteSizeUnit" style="display: none;"></span>
                            </div>
                        </div>
                        <div class="control-row">
                            <div class="control-group">
                                <label>ÂΩ¢Áä∂:</label>
                                <select id="satelliteShape">
                                    <option value="sphere">ÁêÉ‰Ωì</option>
                                    <option value="cube">Á´ãÊñπ‰Ωì</option>
                                    <option value="3dfile">3D„Éï„Ç°„Ç§„É´Ë™≠Ëæº</option>
                                </select>
                            </div>
                        </div>
                        <div class="control-row">
                            <div class="control-group">
                                <input type="checkbox" id="uniformSatelliteColor" class="w-4 h-4 cursor-pointer accent-orange-500">
                                <label for="uniformSatelliteColor">Ëâ≤„ÇíÁµ±‰∏Ä</label>
                                <input type="color" id="satelliteColor" value="#ffffff" class="w-12 h-8 border border-orange-500/30 rounded cursor-pointer transition-all duration-300 hover:border-orange-500 hover:scale-105 hover:shadow-[0_0_15px_rgba(255,127,80,0.3)]">
                            </div>
                        </div>
                        <div id="cubeRotationControls" style="display: none;">
                            <div class="control-group" style="flex-direction: column; align-items: stretch;">
                                <div style="display: flex; align-items: center; margin-bottom: 4px;">
                                    <label style="min-width: 70px;">RËª∏ÂõûËª¢:</label>
                                    <input type="range" id="cubeRotationR" min="0" max="90" step="5" value="0" style="width: 120px; flex: 1;">
                                    <span id="cubeRotationRValue" style="min-width: 30px; text-align: right;">0¬∞</span>
                                </div>
                                <div style="display: flex; align-items: center;">
                                    <label style="min-width: 70px;">SËª∏ÂõûËª¢:</label>
                                    <input type="range" id="cubeRotationS" min="0" max="90" step="5" value="0" style="width: 120px; flex: 1;">
                                    <span id="cubeRotationSValue" style="min-width: 30px; text-align: right;">0¬∞</span>
                                </div>
                            </div>
                        </div>
                        <div id="file3dControls" style="display: none;">
                            <div class="control-row">
                                <div class="control-group">
                                    <label>3D„Éï„Ç°„Ç§„É´:</label>
                                    <input type="file" id="file3dInput" accept=".glb,.gltf,.stl" class="w-0 flex-1 min-w-0 px-2 py-1 bg-white/[0.06] border border-orange-500/20 rounded-md text-white text-xs font-medium transition-all duration-300 hover:bg-white/10 hover:border-orange-500/40 overflow-hidden file:mr-1 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:font-semibold file:bg-orange-500/20 file:text-orange-300 hover:file:bg-orange-500/30">
                                </div>
                            </div>
                            <div class="rotation-controls">
                                <div class="control-row" style="margin-bottom: 4px;">
                                    <div class="control-group">
                                        <label style="min-width: 70px;">RËª∏ÂõûËª¢:</label>
                                        <input type="range" id="file3dRotationR" min="-180" max="180" step="5" value="0" style="flex: 1;">
                                        <span id="file3dRotationRValue" style="min-width: 30px; text-align: right;">0¬∞</span>
                                    </div>
                                </div>
                                <div class="control-row">
                                    <div class="control-group">
                                        <label style="min-width: 70px;">SËª∏ÂõûËª¢:</label>
                                        <input type="range" id="file3dRotationS" min="-180" max="180" step="5" value="0" style="flex: 1;">
                                        <span id="file3dRotationSValue" style="min-width: 30px; text-align: right;">0¬∞</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="control-row">
                            <div class="control-group">
                                <input type="checkbox" id="showTrails" checked>
                                <label>ËªåË∑°Ë°®Á§∫</label>
                            </div>
                        </div>
                        <div class="control-row">
                            <div class="control-group">
                                <label>ËªåË∑°Èï∑„Åï:</label>
                                <input type="range" id="trailLength" min="50" max="500" step="50" value="200">
                                <span id="trailLengthValue" style="font-size: 11px;">200</span>
                            </div>
                        </div>
                    </div>
                    </div>
                    <!-- „Çø„Éñ„Ç≥„É≥„ÉÜ„É≥„ÉÑÁµÇ‰∫Ü: Ë°®Á§∫ -->

                    <!-- „Çø„Éñ„Ç≥„É≥„ÉÜ„É≥„ÉÑ: ÂÜçÁîü„É¢„Éº„Éâ -->
                    <div id="tab-playback" class="tab-content" style="display: none;">
                    <!-- CSVÂÜçÁîü„É¢„Éº„Éâ -->
                    <div class="subsection mb-2 p-2 bg-gradient-to-br from-white/[0.04] to-white/[0.02] border border-orange-500/15 rounded-xl relative overflow-hidden transition-all duration-300 hover:from-white/[0.06] hover:to-white/[0.03] hover:border-orange-500/30 hover:-translate-y-[1px] hover:shadow-[0_4px_12px_rgba(255,127,80,0.1)] before:content-[''] before:absolute before:top-[-1px] before:left-[-1px] before:right-[-1px] before:h-[1px] before:bg-gradient-to-r before:from-transparent before:via-orange-500/40 before:to-transparent before:opacity-0 before:transition-opacity before:duration-300 hover:before:opacity-100">
                        <div class="flex items-center justify-between mb-1 pb-1 border-b border-orange-500/20">
                            <h5 class="subsection-title text-orange-400 text-xs font-bold m-0 uppercase tracking-[1px] flex items-center gap-2">üìä CSVÂÜçÁîü„É¢„Éº„Éâ</h5>
                            <a href="https://github.com/istellartech2/hcw-vis/blob/main/docs/csv-playback-format.md" target="_blank" rel="noopener noreferrer" class="text-orange-400/60 hover:text-orange-400 transition-colors duration-200 text-[10px] flex items-center gap-1" title="CSVÂΩ¢Âºè„ÅÆ„Éò„É´„Éó„ÇíË¶ã„Çã">
                                <span>?</span>
                                <span class="text-[9px] uppercase tracking-wider">ÂΩ¢Âºè</span>
                            </a>
                        </div>
                        <div id="csv-playback">
                            <!-- CSV File Input -->
                            <div class="control-row">
                                <div class="control-group">
                                    <label>CSV„Éï„Ç°„Ç§„É´:</label>
                                    <input type="file" id="csvPlaybackInput" accept=".csv" class="w-0 flex-1 min-w-0 px-2 py-1 bg-white/[0.06] border border-orange-500/20 rounded-md text-white text-xs font-medium transition-all duration-300 hover:bg-white/10 hover:border-orange-500/40 overflow-hidden file:mr-1 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:font-semibold file:bg-orange-500/20 file:text-orange-300 hover:file:bg-orange-500/30">
                                </div>
                            </div>
                            
                            <!-- File Status -->
                            <div id="csvFileStatus" class="control-row">
                                <div class="control-group">
                                    <div class="status-indicator p-2 rounded-lg text-xs bg-orange-500/[0.08] border border-orange-500/20 w-full text-center overflow-hidden">
                                        <span id="csvStatusText" class="text-orange-300/80 block truncate">„Éï„Ç°„Ç§„É´Êú™ÈÅ∏Êäû</span>
                                    </div>
                                </div>
                            </div>
                            
                            
                            <!-- Playback Controls -->
                            <div id="csvPlaybackControls" class="control-section hidden">
                                <h6 class="text-orange-400 text-[13px] font-semibold mb-2 border-b border-orange-500/20 pb-1">ÂÜçÁîüÂà∂Âæ°</h6>
                                
                                <!-- Play/Pause/Stop Controls -->
                                <div class="control-row">
                                    <div class="control-group">
                                        <label>ÂÜçÁîüÂà∂Âæ°:</label>
                                        <div class="flex gap-2">
                                            <button id="csvPlayPause" class="text-sm px-3 py-1.5 bg-orange-500/20 border border-orange-500/30 rounded text-orange-400 hover:bg-orange-500/30 transition-all">‚ñ∂ ÂÜçÁîü</button>
                                            <button id="csvStop" class="text-sm px-3 py-1.5 bg-orange-500/20 border border-orange-500/30 rounded text-orange-400 hover:bg-orange-500/30 transition-all">‚èπ ÂÅúÊ≠¢</button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Time Slider -->
                                <div class="control-row">
                                    <div class="control-group">
                                        <label>ÊôÇÂàª:</label>
                                        <input type="range" id="csvTimeSlider" min="0" max="100" step="0.1" value="0" class="flex-1 h-1 bg-white/10 rounded-sm appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3.5 [&::-webkit-slider-thumb]:h-3.5 [&::-webkit-slider-thumb]:bg-gradient-to-br [&::-webkit-slider-thumb]:from-orange-400 [&::-webkit-slider-thumb]:to-orange-600 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:shadow-[0_2px_6px_rgba(0,0,0,0.3),0_0_8px_rgba(255,127,80,0.4)]">
                                    </div>
                                </div>
                                
                                <!-- Time Display -->
                                <div class="control-row">
                                    <div class="control-group">
                                        <label>ÊôÇÈñì:</label>
                                        <span class="text-[12px] text-orange-300/80 font-mono">
                                            <span id="csvCurrentTime">0.0</span>s / <span id="csvTotalTime">0.0</span>s
                                        </span>
                                    </div>
                                </div>
                                
                                <!-- Loop Control -->
                                <div class="control-row">
                                    <div class="control-group">
                                        <input type="checkbox" id="csvLoopEnabled" checked class="w-4 h-4 cursor-pointer accent-orange-500">
                                        <label for="csvLoopEnabled" class="text-[13px]">„É´„Éº„ÉóÂÜçÁîü</label>
                                    </div>
                                </div>
                                
                                <!-- Data Info -->
                                <div class="control-row">
                                    <div class="data-info p-2 bg-orange-500/[0.08] border border-orange-500/20 rounded-lg">
                                        <div class="text-[12px] text-orange-300/80">
                                            Ë°õÊòüÊï∞: <span id="csvSatelliteCount">0</span><br>
                                            „Éá„Éº„ÇøÁÇπÊï∞: <span id="csvDataPoints">0</span><br>
                                            ÊôÇÈñìÁØÑÂõ≤: <span id="csvTimeRange">0.0-0.0s</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>
                    <!-- „Çø„Éñ„Ç≥„É≥„ÉÜ„É≥„ÉÑÁµÇ‰∫Ü: ÂÜçÁîü„É¢„Éº„Éâ -->
                </div>
            </div>
            <canvas id="canvas" class="w-full h-full touch-none"></canvas>
            
            <!-- Loading Indicator -->
            <div id="loading-indicator" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-[10000] hidden">
                <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
                    <div class="bg-gradient-to-br from-slate-900/95 to-slate-800/90 rounded-2xl border border-orange-500/30 p-8 backdrop-blur-xl shadow-[0_8px_32px_rgba(0,0,0,0.4),0_0_80px_rgba(255,127,80,0.1)] max-w-sm">
                        <div class="flex flex-col items-center gap-4">
                            <!-- Spinner -->
                            <div class="relative w-16 h-16">
                                <div class="absolute inset-0 border-4 border-orange-500/20 rounded-full"></div>
                                <div class="absolute inset-0 border-4 border-transparent border-t-orange-500 rounded-full animate-spin"></div>
                                <div class="absolute inset-2 border-2 border-transparent border-t-orange-400 rounded-full animate-spin animate-[spin_1.5s_linear_infinite_reverse]"></div>
                            </div>
                            
                            <!-- Text -->
                            <div class="text-center">
                                <h3 id="loading-title" class="text-orange-400 text-lg font-bold mb-2">Ë™≠„ÅøËæº„Åø‰∏≠...</h3>
                                <p id="loading-message" class="text-orange-300/80 text-sm">„Éï„Ç°„Ç§„É´„ÇíÂá¶ÁêÜ„Åó„Å¶„ÅÑ„Åæ„Åô</p>
                            </div>
                            
                            <!-- Progress Bar -->
                            <div id="loading-progress-container" class="w-full hidden">
                                <div class="bg-orange-500/20 rounded-full h-2 overflow-hidden">
                                    <div id="loading-progress-bar" class="bg-gradient-to-r from-orange-500 to-orange-400 h-full transition-all duration-300 ease-out" style="width: 0%"></div>
                                </div>
                                <div class="flex justify-between text-xs text-orange-300/60 mt-1">
                                    <span id="loading-progress-text">0%</span>
                                    <span id="loading-file-size"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="axes-info">
                <div class="axis-label" style="color: #ff6b6b">RËª∏: Radial (ÂæÑÊñπÂêë - Âú∞ÂøÉ‚ÜíË°õÊòü)</div>
                <div class="axis-label" style="color: #2ECC71">SËª∏: Along-track (ËªåÈÅìÈÄ≤Ë°åÊñπÂêë)</div>
                <div class="axis-label" style="color: #00BFFF">WËª∏: Cross-track (ËªåÈÅìÈù¢ÂûÇÁõ¥ÊñπÂêë)</div>
            </div>
            
            <!-- Êäò„Çä„Åü„Åü„ÅøÂèØËÉΩ„Å™Âü∫Ê∫ñË°õÊòüÊÉÖÂ†±„Éë„Éç„É´ -->
            <div id="reference-satellite-panel" class="absolute top-[130px] right-5 z-[12] flex flex-col items-end">
                <button id="reference-satellite-toggle" class="panel-toggle flex items-center gap-1.5 px-3 py-2 bg-black/75 border border-orange-500/25 rounded-lg text-white/90 text-xs cursor-pointer transition-all duration-200 backdrop-blur-lg hover:bg-black/85 hover:border-orange-500/40" onclick="toggleReferenceSatelliteInfo()">
                    <span class="icon text-sm">üìç </span>
                    <span class="toggle-arrow text-[10px] transition-transform duration-200">‚ñº</span>
                </button>
                <div id="reference-satellite-content" class="panel-content mt-0 p-2 bg-black/80 border border-orange-500/20 rounded-lg text-[11px] text-white/85 backdrop-blur-lg max-w-[360px] transition-all duration-300 overflow-hidden grid grid-cols-2 gap-3">
                    <div class="panel-column">
                        <div class="info-section">
                            <div class="panel-section-title">üìç ‰ΩçÁΩÆÊÉÖÂ†±</div>
                            <div id="geodetic-info" class="panel-info-content"></div>
                        </div>
                        <div class="info-section">
                            <div class="panel-section-title">üåç ECIÂ∫ßÊ®ôÁ≥ª</div>
                            <div id="eci-info" class="panel-info-content"></div>
                        </div>
                    </div>
                    <div class="panel-column">
                        <div class="info-section">
                            <div class="panel-section-title">üöÄ ËªåÈÅìË¶ÅÁ¥†</div>
                            <div id="orbital-info" class="panel-info-content"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ÊôÇÈñìÂà∂Âæ°„Éë„Éç„É´ -->
            <div id="time-controls-panel" class="absolute bottom-5 right-5 flex flex-col gap-2.5 items-end">
                <div id="time-scale-control" class="flex items-center gap-1.5 px-2 py-1 bg-black/80 rounded-lg border border-orange-500/30 backdrop-blur-lg transition-all duration-300 opacity-80 hover:bg-orange-500/15 hover:opacity-80 hover:shadow-[0_0_15px_rgba(255,127,80,0.3)]">
                    <span class="icon text-sm drop-shadow-[0_0_3px_rgba(255,127,80,0.4)]">‚è±Ô∏è</span>
                    <!-- Simulation speed control -->
                    <select id="timeScale" class="bg-transparent border-none text-orange-500 text-sm font-normal outline-none cursor-pointer px-1 py-0 font-mono">
                        <option value="1">1x (1Áßí/Áßí)</option>
                        <option value="10">10x (10Áßí/Áßí)</option>
                        <option value="60" selected>60x (1ÂàÜ/Áßí)</option>
                        <option value="600">600x (10ÂàÜ/Áßí)</option>
                        <option value="1800">1800x (30ÂàÜ/Áßí)</option>
                        <option value="3600">3600x (1ÊôÇÈñì/Áßí)</option>
                        <option value="7200">7200x (2ÊôÇÈñì/Áßí)</option>
                    </select>
                    <!-- CSV playback speed control -->
                    <select id="csvPlaybackSpeedMain" class="bg-transparent border-none text-orange-500 text-sm font-normal outline-none cursor-pointer px-1 py-0 font-mono" style="display: none;">
                        <option value="1">1x (1Áßí/Áßí)</option>
                        <option value="10">10x (10Áßí/Áßí)</option>
                        <option value="60" selected>60x (1ÂàÜ/Áßí)</option>
                        <option value="600">600x (10ÂàÜ/Áßí)</option>
                        <option value="1800">1800x (30ÂàÜ/Áßí)</option>
                        <option value="3600">3600x (1ÊôÇÈñì/Áßí)</option>
                        <option value="7200">7200x (2ÊôÇÈñì/Áßí)</option>
                    </select>
                </div>
                <div id="time-display" onclick="togglePause()" title="„ÇØ„É™„ÉÉ„ÇØ„Åß‰∏ÄÊôÇÂÅúÊ≠¢/ÂÜçÈñã" class="px-4 py-3 bg-black/70 rounded-lg text-base font-bold text-orange-500 border border-orange-500/30 drop-shadow-[0_0_10px_rgba(255,127,80,0.5)] font-mono tracking-[0.5px] cursor-pointer select-none transition-all duration-300 hover:bg-orange-500/20 hover:scale-105">
                    <span id="simulationTime">00ÂàÜ00Áßí</span>
                </div>
            </div>

            <!-- „Éï„Ç©„Éº„É°„Éº„Ç∑„Éß„É≥Ë®≠Ë®à„É¢„Éº„ÉÄ„É´ -->
            <div id="formation-designer-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] hidden items-center justify-center">
                <div class="bg-gradient-to-br from-slate-900/98 to-slate-800/95 rounded-2xl border border-orange-500/30 shadow-[0_20px_60px_rgba(0,0,0,0.8)] max-w-4xl w-full max-h-[90vh] flex flex-col overflow-hidden">
                    <!-- Header -->
                    <div class="flex items-center justify-between px-6 py-4 border-b border-orange-500/20 bg-orange-500/[0.08]">
                        <h2 class="text-orange-400 text-2xl font-bold drop-shadow-[0_0_20px_rgba(255,127,80,0.5)]">üîß „Éï„Ç©„Éº„É°„Éº„Ç∑„Éß„É≥Ë®≠Ë®à</h2>
                        <div class="flex gap-2">
                            <button id="formation-json-export" class="px-4 py-2 bg-orange-500/20 border border-orange-500/30 rounded-lg text-orange-400 text-sm font-semibold hover:bg-orange-500/30 transition-all">üíæ JSON‰øùÂ≠ò</button>
                            <input type="file" id="formation-json-input" accept=".json" class="hidden">
                            <button id="formation-json-import" class="px-4 py-2 bg-orange-500/20 border border-orange-500/30 rounded-lg text-orange-400 text-sm font-semibold hover:bg-orange-500/30 transition-all">üìÇ JSONË™≠Ëæº</button>
                            <button id="formation-preview" class="px-4 py-2 bg-orange-500/20 border border-orange-500/30 rounded-lg text-orange-400 text-sm font-semibold hover:bg-orange-500/30 transition-all">üëÅÔ∏è „Éó„É¨„Éì„É•„Éº</button>
                            <button id="formation-close" class="px-4 py-2 bg-white/5 border border-orange-500/30 rounded-lg text-orange-400 text-xl hover:bg-orange-500/20 transition-all">√ó</button>
                        </div>
                    </div>

                    <!-- Content -->
                    <div class="flex-1 overflow-y-auto p-6">
                        <!-- Layers List Header -->
                        <div class="mb-4 flex items-center justify-between">
                            <div class="flex items-center gap-4">
                                <h3 class="text-orange-400 text-lg font-bold">„É¨„Ç§„É§„Éº</h3>
                                <!-- Formation Info (compact) -->
                                <div class="flex items-center gap-2 text-xs text-orange-300/60">
                                    <input type="text" id="formation-name" value="Êñ∞„Åó„ÅÑ„Éï„Ç©„Éº„É°„Éº„Ç∑„Éß„É≥" placeholder="ÂêçÂâç" class="px-2 py-1 bg-white/[0.04] border border-orange-500/10 rounded text-white text-xs w-48">
                                    <input type="text" id="formation-description" placeholder="Ë™¨ÊòéÔºà‰ªªÊÑèÔºâ" class="px-2 py-1 bg-white/[0.04] border border-orange-500/10 rounded text-white text-xs w-48">
                                </div>
                            </div>
                            <div class="flex items-center gap-4">
                                <span id="formation-total-satellites" class="text-orange-300/80 text-sm">ÂêàË®à: 0 ÂÄã</span>
                                <button id="formation-add-layer" class="px-4 py-2 bg-orange-500/20 border border-orange-500/30 rounded-lg text-orange-400 text-sm font-semibold hover:bg-orange-500/30 transition-all">+ „É¨„Ç§„É§„ÉºËøΩÂä†</button>
                            </div>
                        </div>

                        <div id="formation-layers-container" class="space-y-3">
                            <!-- Layers will be added here dynamically -->
                            <div class="text-center text-orange-300/50 py-8">„É¨„Ç§„É§„Éº„ÇíËøΩÂä†„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- „É¨„Ç§„É§„ÉºÁ∑®ÈõÜ„É¢„Éº„ÉÄ„É´ -->
            <div id="layer-editor-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-[10002] hidden items-center justify-center">
                <div class="bg-gradient-to-br from-slate-900/98 to-slate-800/95 rounded-2xl border border-orange-500/30 shadow-[0_20px_60px_rgba(0,0,0,0.8)] max-w-2xl w-full max-h-[90vh] flex flex-col overflow-hidden">
                    <!-- Header -->
                    <div class="flex items-center justify-between px-6 py-4 border-b border-orange-500/20 bg-orange-500/[0.08]">
                        <h2 class="text-orange-400 text-xl font-bold drop-shadow-[0_0_20px_rgba(255,127,80,0.5)]">‚úèÔ∏è „É¨„Ç§„É§„ÉºÁ∑®ÈõÜ</h2>
                        <button id="layer-editor-close" class="px-3 py-1 bg-white/5 border border-orange-500/30 rounded-lg text-orange-400 text-xl hover:bg-orange-500/20 transition-all">√ó</button>
                    </div>

                    <!-- Content -->
                    <div class="flex-1 overflow-y-auto p-6">
                        <div class="space-y-4">
                            <!-- Layer Name -->
                            <div>
                                <label class="block text-orange-400 text-sm font-semibold mb-2">„É¨„Ç§„É§„ÉºÂêç:</label>
                                <input type="text" id="layer-edit-name" class="w-full px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm">
                            </div>

                            <!-- Pattern -->
                            <div>
                                <label class="block text-orange-400 text-sm font-semibold mb-2">ÈÖçÁΩÆ„Éë„Çø„Éº„É≥:</label>
                                <select id="layer-edit-pattern" class="w-full px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm cursor-pointer">
                                    <option value="axis">Ëª∏‰∏ä-ÈÄüÂ∫¶0</option>
                                    <option value="grid">Ê†ºÂ≠ê-ÈÄüÂ∫¶0</option>
                                    <option value="random_position">„É©„É≥„ÉÄ„É†-ÈÄüÂ∫¶0</option>
                                    <option value="random_position_velocity">„É©„É≥„ÉÄ„É†</option>
                                    <option value="random_periodic">„É©„É≥„ÉÄ„É†-Âë®ÊúüËß£</option>
                                    <option value="periodic_orbit">Ê•ïÂÜÜËªåÈÅì</option>
                                    <option value="circular_orbit">ÂÜÜËªåÈÅì</option>
                                    <option value="hexagonal_disk">ÂÜÜÁõ§ËªåÈÅìÔºàÂÖ≠ËßíÊ†ºÂ≠êÔºâ</option>
                                    <option value="concentric_disk">ÂÜÜÁõ§ËªåÈÅìÔºàÂêåÂøÉ„É™„É≥„Ç∞Ôºâ</option>
                                    <option value="vbar_approach">V-barËªåÈÅì</option>
                                    <option value="rbar_approach">R-barËªåÈÅì</option>
                                </select>
                            </div>

                            <!-- Placement Mode -->
                            <div id="layer-edit-placement-mode-group">
                                <label class="block text-orange-400 text-sm font-semibold mb-2">ÈÖçÁΩÆÊñπÂºè:</label>
                                <select id="layer-edit-placement-mode" class="w-full px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm cursor-pointer">
                                    <option value="radius">ÁØÑÂõ≤ÊåáÂÆö</option>
                                    <option value="spacing">Ë°õÊòüÈñìË∑ùÈõ¢</option>
                                </select>
                            </div>

                            <!-- Radius (conditional) -->
                            <div id="layer-edit-radius-group">
                                <label class="block text-orange-400 text-sm font-semibold mb-2">ÁØÑÂõ≤ (m):</label>
                                <input type="number" id="layer-edit-radius" min="0.1" max="10000" step="0.1" class="w-full px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm">
                            </div>

                            <!-- Spacing (conditional) -->
                            <div id="layer-edit-spacing-group" style="display: none;">
                                <label class="block text-orange-400 text-sm font-semibold mb-2">Ë°õÊòüÈñìË∑ùÈõ¢ (m):</label>
                                <input type="number" id="layer-edit-spacing" min="0.01" max="1000" step="0.01" class="w-full px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm">
                            </div>

                            <!-- Satellite Count -->
                            <div>
                                <label class="block text-orange-400 text-sm font-semibold mb-2">Ë°õÊòüÊï∞:</label>
                                <input type="number" id="layer-edit-count" min="1" max="200" step="1" class="w-full px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm">
                            </div>

                            <!-- Shape -->
                            <div>
                                <label class="block text-orange-400 text-sm font-semibold mb-2">ÂΩ¢Áä∂:</label>
                                <select id="layer-edit-shape" class="w-full px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm cursor-pointer">
                                    <option value="sphere">ÁêÉ‰Ωì</option>
                                    <option value="cube">Á´ãÊñπ‰Ωì</option>
                                    <option value="box">Áõ¥Êñπ‰Ωì</option>
                                    <option value="3dfile">3D„Éï„Ç°„Ç§„É´</option>
                                </select>
                            </div>

                            <!-- Size -->
                            <div>
                                <label class="block text-orange-400 text-sm font-semibold mb-2">„Çµ„Ç§„Ç∫ (m):</label>
                                <input type="number" id="layer-edit-size" min="0.01" max="100" step="0.01" class="w-full px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm">
                            </div>

                            <!-- Box Ratios (conditional) -->
                            <div id="layer-edit-box-ratios-group" style="display: none;">
                                <label class="block text-orange-400 text-sm font-semibold mb-2">Áõ¥Êñπ‰Ωì„ÅÆÊØîÁéá (X:Y:Z):</label>
                                <div class="grid grid-cols-3 gap-2">
                                    <input type="number" id="layer-edit-box-x" min="0.1" max="10" step="0.1" placeholder="X" class="px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm">
                                    <input type="number" id="layer-edit-box-y" min="0.1" max="10" step="0.1" placeholder="Y" class="px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm">
                                    <input type="number" id="layer-edit-box-z" min="0.1" max="10" step="0.1" placeholder="Z" class="px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm">
                                </div>
                            </div>

                            <!-- Rotation (for cube/box) -->
                            <div id="layer-edit-rotation-group" style="display: none;">
                                <label class="block text-orange-400 text-sm font-semibold mb-2">ÂõûËª¢ (Â∫¶):</label>
                                <div class="grid grid-cols-2 gap-2">
                                    <div>
                                        <label class="block text-orange-400/70 text-xs mb-1">RËª∏:</label>
                                        <input type="number" id="layer-edit-rotation-r" min="-180" max="180" step="5" class="w-full px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm">
                                    </div>
                                    <div>
                                        <label class="block text-orange-400/70 text-xs mb-1">SËª∏:</label>
                                        <input type="number" id="layer-edit-rotation-s" min="-180" max="180" step="5" class="w-full px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm">
                                    </div>
                                </div>
                            </div>

                            <!-- Color -->
                            <div>
                                <label class="block text-orange-400 text-sm font-semibold mb-2">Ëâ≤:</label>
                                <div class="space-y-2">
                                    <select id="layer-edit-color-mode" class="w-full px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm cursor-pointer">
                                        <option value="uniform">Áµ±‰∏ÄËâ≤</option>
                                        <option value="random">„É©„É≥„ÉÄ„É†</option>
                                    </select>
                                    <div id="layer-edit-color-picker-group" class="flex items-center gap-3">
                                        <input type="color" id="layer-edit-color" class="w-16 h-10 border border-orange-500/30 rounded cursor-pointer">
                                        <input type="text" id="layer-edit-color-text" placeholder="#4ecdc4" pattern="^#[0-9a-fA-F]{6}$" class="flex-1 px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm font-mono">
                                    </div>
                                </div>
                            </div>

                            <!-- Z Amplitude (for periodic_orbit) -->
                            <div id="layer-edit-zamplitude-group" style="display: none;">
                                <label class="block text-orange-400 text-sm font-semibold mb-2">ZÊåØÂπÖÂÄçÁéá:</label>
                                <input type="number" id="layer-edit-zamplitude" min="-3" max="3" step="0.1" class="w-full px-3 py-2 bg-white/[0.06] border border-orange-500/20 rounded-lg text-white text-sm">
                            </div>

                            <!-- Periodic Parameters (for periodic_orbit) -->
                            <div id="layer-edit-periodic-group" style="display: none;">
                                <label class="block text-orange-400 text-sm font-semibold mb-2">Ê•ïÂÜÜËªåÈÅì„Éë„É©„É°„Éº„Çø:</label>
                                <div class="space-y-2 p-3 bg-white/[0.04] border border-orange-500/15 rounded-lg">
                                    <div class="text-xs text-orange-300/60 mb-2">A=ÁØÑÂõ≤„ÄÅB„ÄúF=AÊØî</div>
                                    <div class="grid grid-cols-5 gap-2">
                                        <div>
                                            <label class="block text-orange-400/70 text-xs mb-1">B/A:</label>
                                            <input type="number" id="layer-edit-param-b" min="-3" max="3" step="0.1" class="w-full px-2 py-1 bg-white/[0.06] border border-orange-500/20 rounded text-white text-xs">
                                        </div>
                                        <div>
                                            <label class="block text-orange-400/70 text-xs mb-1">D/A:</label>
                                            <input type="number" id="layer-edit-param-d" min="-3" max="3" step="0.1" class="w-full px-2 py-1 bg-white/[0.06] border border-orange-500/20 rounded text-white text-xs">
                                        </div>
                                        <div>
                                            <label class="block text-orange-400/70 text-xs mb-1">E/A:</label>
                                            <input type="number" id="layer-edit-param-e" min="-3" max="3" step="0.1" class="w-full px-2 py-1 bg-white/[0.06] border border-orange-500/20 rounded text-white text-xs">
                                        </div>
                                        <div>
                                            <label class="block text-orange-400/70 text-xs mb-1">F/A:</label>
                                            <input type="number" id="layer-edit-param-f" min="-3" max="3" step="0.1" class="w-full px-2 py-1 bg-white/[0.06] border border-orange-500/20 rounded text-white text-xs">
                                        </div>
                                    </div>
                                    <div class="mt-2 p-2 bg-orange-500/[0.08] border border-orange-500/20 rounded">
                                        <span class="text-orange-400 text-xs">Èõ¢ÂøÉÁéá e: </span>
                                        <span id="layer-edit-eccentricity" class="text-orange-400 text-sm font-bold font-mono">0.00</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Positive Z (for circular_orbit) -->
                            <div id="layer-edit-positivez-group" style="display: none;">
                                <div class="flex items-center gap-2">
                                    <input type="checkbox" id="layer-edit-positivez" checked class="w-4 h-4 cursor-pointer accent-orange-500">
                                    <label for="layer-edit-positivez" class="text-orange-400 text-sm cursor-pointer">+ZÊñπÂêë„Å´ÂõûËª¢</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Footer -->
                    <div class="flex items-center justify-end gap-3 px-6 py-4 border-t border-orange-500/20 bg-white/[0.02]">
                        <button id="layer-editor-cancel" class="px-4 py-2 bg-white/5 border border-orange-500/30 rounded-lg text-orange-400 text-sm hover:bg-white/10 transition-all">„Ç≠„É£„É≥„Çª„É´</button>
                        <button id="layer-editor-save" class="px-4 py-2 bg-orange-500/20 border border-orange-500/30 rounded-lg text-orange-400 text-sm font-semibold hover:bg-orange-500/30 transition-all">‰øùÂ≠ò</button>
                    </div>
                </div>
            </div>

        </div>





    </div>

    <script type="module" src="./src/main.ts"></script>
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const hamburger = document.getElementById('hamburger-menu');
            sidebar.classList.toggle('open');
            hamburger.classList.toggle('active');
        }
        
        function toggleSidebarSection(sectionId) {
            const section = document.getElementById(sectionId);
            const toggle = document.getElementById(sectionId + '-toggle');
            section.classList.toggle('collapsed');
            toggle.textContent = section.classList.contains('collapsed') ? '‚ñ∂' : '‚ñº';
        }
        
        function toggleCSVControls() {
            const content = document.getElementById('csv-controls-content');
            const toggle = document.getElementById('csv-controls-toggle');

            if (content.style.display === 'none' || !content.style.display) {
                content.style.display = 'flex';
                toggle.textContent = '‚ñº';
            } else {
                content.style.display = 'none';
                toggle.textContent = '‚ñ∂';
            }
        }

        // „Çø„ÉñÂàá„ÇäÊõø„ÅàÈñ¢Êï∞
        function switchTab(tabName) {
            // „Åô„Åπ„Å¶„ÅÆ„Çø„Éñ„Éú„Çø„É≥„Å®„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÇíÂèñÂæó
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            // „Åô„Åπ„Å¶„ÅÆ„Çø„Éñ„Éú„Çø„É≥„Åã„Çâactive„ÇØ„É©„Çπ„ÇíÂâäÈô§
            tabButtons.forEach(button => {
                button.classList.remove('active');
                const indicator = button.querySelector('.tab-indicator');
                if (indicator) {
                    indicator.style.opacity = '0';
                }
            });

            // „Åô„Åπ„Å¶„ÅÆ„Çø„Éñ„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÇíÈùûË°®Á§∫„Å´„Åô„Çã
            tabContents.forEach(content => {
                content.style.display = 'none';
                content.classList.remove('active');
            });

            // ÈÅ∏Êäû„Åï„Çå„Åü„Çø„Éñ„Çí„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Å´„Åô„Çã
            const activeButton = document.querySelector(`[data-tab="${tabName}"]`);
            const activeContent = document.getElementById(`tab-${tabName}`);

            if (activeButton && activeContent) {
                activeButton.classList.add('active');
                const indicator = activeButton.querySelector('.tab-indicator');
                if (indicator) {
                    indicator.style.opacity = '1';
                }
                activeContent.style.display = 'block';
                activeContent.classList.add('active');
            }
        }

        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„Å´„Éá„Éï„Ç©„É´„Éà„ÅÆ„Çø„Éñ„ÇíË°®Á§∫
        document.addEventListener('DOMContentLoaded', function() {
            switchTab('simulation');
        });

        // „Çµ„Ç§„Éâ„Éê„ÉºÂ§ñ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Åü„Å®„Åç„Å´Èñâ„Åò„Çã
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const hamburger = document.getElementById('hamburger-menu');
            if (sidebar.classList.contains('open') && 
                !sidebar.contains(event.target) && 
                !hamburger.contains(event.target)) {
                sidebar.classList.remove('open');
                hamburger.classList.remove('active');
            }
        });
    </script>
</body>
</html>
